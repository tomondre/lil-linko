<!DOCTYPE html>
<html>
<body>

<h2>Lil Linko Generator</h2>
<form>
    <label for="url">Url: </label><br>
    <input type="text" id="url" name="url" placeholder="https://google.com"><br>
    <input type="submit">
</form>
<a href="" target="_blank"></a>
<span></span>

<script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js">
</script>
<script>
    $(document).ready(function() {
        $('form').on('submit', function(event) {
            event.preventDefault();

            // It returns a array of object
            let linkData = $(this).serializeArray();
            console.log(linkData);
            let link = {};
            linkData.forEach((value) => {

                // Dynamically create an object
                link[value.name] = value.value;
            });
            let url = "/links";
            console.log(link);
            $.ajax({
                method: "POST",
                url: url,
                contentType: "application/json",
                data: JSON.stringify(link)
            }).done(function(msg) {
                let url = `{{HOST_URL}}/${msg.id}`;
                let a = $('a');
                a.attr("href", url);
                a.text(url);
            }).fail(function(err, textstatus, error) {
                $('span').text(err.responseText);
            });
        });
    });
</script>
</body>
</html> 